#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f neoport.src.bash 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[6]))
	"\371\065\271\365\265\037\340\252\254\172\213\214\144\014\355\356"
	"\106\250\237\224\157\223\050\201\250\122\117\167\230\052\104\274"
	"\001\113\064\314\277\316\272\040\315\054\245\057\210\042\137\337"
	"\231\351\106\342\062\352\100\357\022\337\153\346\364\335\347\157"
	"\210\371\064\303\302\353\377\140\165\140\030\203\165\143"
#define      xecc_z	15
#define      xecc	((&data[79]))
	"\167\241\156\005\374\057\011\000\351\254\221\317\203\216\044\357"
	"\252\363"
#define      date_z	1
#define      date	((&data[96]))
	"\004"
#define      rlax_z	1
#define      rlax	((&data[97]))
	"\263"
#define      chk1_z	22
#define      chk1	((&data[100]))
	"\246\273\261\074\304\345\026\347\105\336\125\171\035\107\316\265"
	"\060\001\020\012\335\076\306\237\310\237"
#define      chk2_z	19
#define      chk2	((&data[126]))
	"\245\242\110\014\225\052\172\262\022\035\333\154\306\152\263\200"
	"\170\103\376\025\346\365\032"
#define      pswd_z	256
#define      pswd	((&data[150]))
	"\170\162\372\135\350\057\015\315\240\165\153\274\041\003\262\356"
	"\012\343\104\053\250\071\174\276\037\256\026\001\261\130\154\354"
	"\345\265\111\316\344\127\234\204\314\007\100\356\013\363\334\025"
	"\326\041\101\177\133\275\075\172\154\124\173\036\255\347\012\222"
	"\235\124\141\201\253\375\006\170\005\106\146\020\072\102\046\021"
	"\144\147\220\277\045\316\072\221\042\266\257\317\236\272\142\073"
	"\017\303\275\273\301\303\063\307\012\232\327\105\335\375\126\101"
	"\145\346\000\212\264\073\034\326\361\314\246\217\207\010\312\226"
	"\314\207\122\216\113\206\125\126\040\054\233\375\052\361\076\220"
	"\327\077\033\214\172\067\143\153\004\011\373\213\021\305\042\335"
	"\115\165\153\231\373\300\357\033\355\212\030\030\173\126\250\123"
	"\226\303\340\020\373\103\174\377\114\167\213\136\075\255\074\213"
	"\042\247\044\035\150\023\071\126\236\121\156\032\250\026\156\076"
	"\332\116\116\325\221\313\324\336\102\137\075\177\015\171\012\060"
	"\041\057\115\211\103\207\340\341\330\117\374\200\146\152\277\100"
	"\270\016\025\112\331\352\051\033\111\146\233\127\337\245\207\000"
	"\325\325\212\330\376\162\202\362\205\204\305\076\015\230\314\153"
	"\365\162\046\276\022\026\100\247\274\342\235\327\344\254\165\135"
	"\036\160\065\035\342\270\017\150\074\324\246"
#define      inlo_z	3
#define      inlo	((&data[446]))
	"\320\154\313"
#define      opts_z	1
#define      opts	((&data[449]))
	"\165"
#define      text_z	3500
#define      text	((&data[562]))
	"\363\141\240\260\103\076\210\050\352\376\206\010\157\274\045\121"
	"\164\064\272\261\010\140\373\165\324\262\330\272\217\371\262\203"
	"\132\123\063\236\221\274\307\173\273\115\203\052\011\250\174\176"
	"\335\066\060\346\227\054\133\153\336\063\045\155\055\330\360\207"
	"\053\044\045\275\340\354\070\233\072\273\306\103\144\102\302\101"
	"\170\362\050\017\036\203\172\374\267\240\151\345\171\131\154\245"
	"\176\222\142\136\176\232\372\271\126\300\374\273\003\277\375\173"
	"\160\073\211\377\157\216\156\072\001\320\354\324\107\274\264\170"
	"\172\304\211\267\355\214\174\233\275\350\235\070\306\105\222\211"
	"\150\172\116\106\102\202\270\200\311\123\326\256\175\070\210\345"
	"\113\125\133\327\116\054\162\150\132\133\357\066\203\330\050\077"
	"\102\050\102\331\154\234\040\335\334\314\276\305\162\316\216\031"
	"\344\137\151\023\146\342\051\170\254\316\253\154\021\260\355\342"
	"\354\272\214\266\205\350\013\242\071\247\227\030\150\163\233\325"
	"\072\027\271\253\243\102\307\045\223\277\307\357\322\172\104\365"
	"\164\366\330\250\310\345\331\057\043\260\127\245\050\240\301\316"
	"\234\311\357\146\277\074\276\034\157\261\053\307\226\366\054\373"
	"\316\221\003\167\316\174\334\001\113\147\144\301\370\026\316\337"
	"\041\155\352\312\340\257\017\173\023\236\327\041\173\043\305\132"
	"\056\103\222\260\242\113\333\036\064\040\306\127\321\143\054\131"
	"\031\254\246\031\256\134\355\100\003\134\370\172\061\030\255\264"
	"\063\341\056\247\301\003\276\165\343\015\054\331\017\025\141\010"
	"\360\305\131\222\045\333\035\324\335\325\354\040\357\175\325\034"
	"\166\315\377\345\106\070\234\247\271\106\021\233\342\147\105\173"
	"\236\127\042\163\104\001\145\242\042\075\005\151\313\315\012\232"
	"\346\276\005\361\227\220\341\163\202\116\255\270\176\270\335\334"
	"\117\163\170\047\206\364\166\302\270\171\245\112\046\024\264\130"
	"\340\345\135\153\241\220\041\327\062\151\272\143\336\277\151\322"
	"\303\254\375\335\124\360\007\212\076\003\332\327\317\306\123\114"
	"\275\140\205\016\157\153\147\153\206\376\342\020\046\015\244\173"
	"\262\036\152\354\032\032\267\256\126\331\220\344\135\102\216\132"
	"\357\007\151\057\022\270\101\303\047\274\154\347\130\233\147\304"
	"\071\270\342\072\341\157\066\027\150\336\226\321\344\340\065\105"
	"\337\263\374\146\131\372\264\173\175\335\157\162\112\137\156\342"
	"\345\270\214\111\032\055\116\375\311\062\044\223\267\030\236\304"
	"\166\122\032\161\152\303\140\365\010\370\043\276\220\205\271\307"
	"\356\321\017\057\010\231\271\151\133\252\162\025\372\241\001\225"
	"\057\020\342\015\130\045\224\325\342\323\161\261\206\164\375\146"
	"\114\267\120\006\146\246\056\210\175\151\277\342\031\003\231\024"
	"\307\104\232\036\141\170\051\042\361\272\356\152\135\015\077\235"
	"\054\171\120\171\164\233\017\133\342\147\323\275\342\033\212\041"
	"\124\224\315\044\272\010\251\005\361\256\350\264\253\233\006\221"
	"\103\047\304\302\022\074\060\040\262\304\341\360\073\112\121\011"
	"\261\307\345\367\214\102\273\211\061\237\204\075\355\076\126\207"
	"\311\241\025\121\124\051\114\200\127\005\217\344\175\326\356\046"
	"\162\104\372\001\231\251\307\354\257\100\216\002\053\076\202\357"
	"\152\154\022\063\106\013\124\337\320\347\360\325\216\245\242\135"
	"\055\063\075\107\016\327\120\004\332\336\073\364\063\110\145\262"
	"\050\300\030\302\263\322\247\105\217\312\215\204\126\326\300\307"
	"\200\267\371\324\363\103\300\307\104\101\255\015\350\307\053\120"
	"\264\120\037\163\320\061\024\156\350\140\114\061\155\120\312\141"
	"\325\167\041\151\036\325\206\377\373\166\211\250\063\255\310\062"
	"\001\275\152\247\226\140\265\305\265\340\115\134\342\172\352\051"
	"\015\111\366\336\151\026\051\352\353\123\065\176\110\110\363\035"
	"\173\060\304\230\302\353\106\136\312\053\162\365\001\046\314\114"
	"\312\216\204\350\317\233\060\254\076\174\067\034\113\207\374\267"
	"\056\057\254\014\170\113\355\243\031\336\153\144\126\173\215\315"
	"\146\042\215\070\235\015\324\266\224\003\260\246\324\321\254\215"
	"\100\211\115\153\326\272\054\330\372\235\203\251\100\046\303\112"
	"\363\225\123\034\257\146\241\113\006\305\213\133\177\022\303\170"
	"\064\357\121\117\214\206\356\106\132\345\210\223\057\264\037\130"
	"\173\221\006\002\117\363\362\261\222\134\353\176\173\220\070\341"
	"\217\254\011\043\247\222\054\247\353\133\343\356\350\137\275\214"
	"\223\072\322\051\114\006\223\332\055\327\260\113\002\045\342\003"
	"\063\153\223\101\231\340\020\310\061\011\227\001\254\317\130\162"
	"\301\341\300\215\172\022\230\335\267\050\254\117\355\262\044\074"
	"\070\252\177\233\377\270\133\263\003\160\235\356\256\077\303\271"
	"\066\204\022\273\042\367\054\324\132\153\066\362\330\034\334\221"
	"\222\302\375\264\030\374\143\207\121\057\073\324\224\307\073\231"
	"\251\114\031\275\070\140\120\354\107\145\127\246\121\164\205\152"
	"\031\225\256\070\311\264\331\127\224\253\151\075\225\251\314\056"
	"\044\237\073\267\222\211\135\036\252\356\214\246\055\230\376\107"
	"\207\340\240\227\120\123\243\203\350\250\364\146\230\146\115\222"
	"\243\127\245\255\153\030\373\137\103\216\331\006\334\002\353\324"
	"\236\237\365\146\043\132\246\114\110\106\267\275\270\132\011\204"
	"\022\216\271\135\216\250\056\073\136\373\236\001\020\002\157\143"
	"\176\103\030\210\305\214\351\002\044\336\211\105\133\106\351\160"
	"\230\245\171\237\241\316\127\000\245\266\000\225\331\015\056\025"
	"\066\012\334\350\367\073\257\011\163\262\261\366\302\050\216\252"
	"\340\354\244\325\170\253\261\336\214\305\005\204\104\225\012\101"
	"\374\040\210\223\241\312\061\057\227\212\103\300\205\056\157\364"
	"\253\326\105\221\206\030\246\273\321\247\136\046\152\140\132\310"
	"\321\230\003\372\310\135\006\357\042\351\320\354\360\227\232\227"
	"\354\310\016\163\265\332\266\042\007\176\074\025\337\171\365\265"
	"\141\032\064\342\362\146\335\362\215\263\171\015\275\027\167\162"
	"\357\351\333\314\115\031\221\150\332\317\165\016\202\007\206\340"
	"\062\262\171\242\337\102\032\132\342\164\316\137\351\061\315\137"
	"\161\112\006\235\376\031\000\330\161\072\274\205\365\024\037\324"
	"\352\251\176\177\257\300\047\136\355\257\354\263\306\331\342\262"
	"\306\053\250\342\102\306\125\127\303\333\103\013\131\154\023\253"
	"\334\320\313\061\137\060\051\366\264\227\340\264\023\046\237\100"
	"\026\310\355\211\104\032\032\367\040\031\047\153\237\100\205\362"
	"\123\351\002\106\264\227\142\261\267\316\352\136\251\165\373\277"
	"\272\000\050\122\044\311\274\203\347\346\171\075\246\242\010\007"
	"\277\243\171\065\362\355\244\236\335\010\014\325\023\033\121\101"
	"\233\001\147\207\271\037\231\275\014\330\217\216\052\116\237\333"
	"\217\166\144\007\251\065\237\162\020\210\270\001\057\010\357\134"
	"\026\141\142\360\022\263\226\123\331\005\116\141\247\064\007\312"
	"\225\124\365\021\113\356\065\373\032\175\135\017\205\152\231\226"
	"\170\037\114\125\120\333\312\152\157\175\053\075\022\355\034\064"
	"\352\037\137\007\101\075\272\240\276\241\302\146\375\277\150\240"
	"\230\247\057\145\303\311\366\122\231\277\021\351\273\142\323\172"
	"\003\250\375\172\113\243\217\351\112\005\275\121\135\124\025\074"
	"\164\300\113\374\263\362\074\226\360\067\036\107\372\064\035\176"
	"\267\233\040\234\347\174\356\333\034\150\145\272\012\135\373\057"
	"\033\302\265\122\224\046\246\256\222\113\221\236\221\245\217\205"
	"\141\105\070\066\245\265\127\216\021\213\077\162\065\130\366\101"
	"\231\177\261\014\002\106\051\307\056\260\205\307\041\073\156\043"
	"\333\054\074\361\104\160\240\312\353\213\315\265\332\135\311\325"
	"\213\076\270\316\170\033\107\006\113\370\241\075\224\241\032\222"
	"\164\033\234\171\057\072\110\003\361\325\141\255\032\221\331\113"
	"\310\035\376\303\360\321\226\110\325\244\211\343\062\321\220\200"
	"\333\331\326\134\204\307\116\153\144\213\243\067\025\105\136\072"
	"\053\172\005\155\374\043\355\064\242\162\146\102\244\230\340\232"
	"\164\331\067\367\266\341\055\343\304\025\265\065\357\205\346\366"
	"\072\246\306\076\101\277\327\360\076\054\145\073\254\233\007\371"
	"\031\162\043\255\163\230\127\164\034\340\046\340\235\232\211\071"
	"\353\201\012\065\336\114\216\161\340\306\156\362\042\335\010\044"
	"\103\140\300\120\235\002\315\033\225\370\172\342\360\101\120\117"
	"\020\302\165\321\013\004\102\367\104\354\045\305\001\264\160\141"
	"\153\106\137\220\165\226\355\135\310\352\321\253\150\172\250\064"
	"\065\124\244\202\341\237\271\231\057\173\215\165\227\276\264\274"
	"\323\021\057\170\233\143\175\151\033\152\004\336\231\227\333\023"
	"\226\211\311\124\104\273\046\000\214\126\361\304\043\135\154\323"
	"\130\316\205\223\346\073\271\205\220\041\372\303\152\317\207\355"
	"\073\050\231\227\273\245\062\047\331\110\011\162\175\130\143\310"
	"\240\367\307\130\112\232\125\010\331\067\005\033\173\362\146\124"
	"\373\000\126\017\254\110\214\105\326\022\362\047\113\050\166\304"
	"\034\215\143\242\311\350\374\255\225\132\347\202\023\224\255\026"
	"\146\065\370\347\207\330\230\165\266\137\250\070\015\151\310\173"
	"\356\103\211\006\146\377\102\333\255\167\236\375\060\211\025\064"
	"\164\116\106\322\251\261\112\010\040\276\262\327\235\160\374\163"
	"\012\064\242\032\010\267\130\132\011\007\217\236\063\005\300\241"
	"\135\112\256\043\363\263\365\232\033\070\237\045\271\107\274\243"
	"\225\021\023\373\134\072\122\154\123\321\111\315\215\131\060\116"
	"\040\032\130\220\261\174\345\312\125\137\172\321\244\237\270\106"
	"\253\077\170\005\372\352\202\210\151\245\335\341\045\345\254\141"
	"\011\113\172\023\112\377\031\363\235\112\336\177\350\122\240\244"
	"\212\350\246\171\053\127\157\051\225\106\262\263\255\332\055\152"
	"\317\264\200\201\146\326\347\170\315\241\320\127\034\331\151\314"
	"\175\313\034\344\157\213\020\067\017\104\064\117\255\135\305\361"
	"\375\144\073\142\107\277\200\373\077\116\060\060\231\333\022\352"
	"\156\351\241\255\171\042\024\164\332\163\125\024\114\051\361\262"
	"\307\125\140\007\063\133\354\217\205\065\263\146\226\054\174\065"
	"\321\166\166\176\004\165\107\332\046\044\051\117\031\374\153\274"
	"\311\113\037\361\255\047\247\165\363\136\265\246\154\204\232\064"
	"\051\367\161\320\326\057\274\102\023\112\140\270\154\224\125\323"
	"\260\031\236\125\304\061\212\324\223\076\113\037\356\312\271\063"
	"\162\021\342\324\322\007\362\066\245\261\024\256\266\034\241\357"
	"\234\020\244\154\243\222\071\052\251\214\375\076\035\014\157\201"
	"\246\133\044\357\246\305\133\135\244\375\206\030\010\020\032\074"
	"\077\023\312\233\255\215\350\007\334\376\262\312\107\322\276\130"
	"\231\237\143\305\141\152\304\166\165\025\323\366\277\263\336\300"
	"\065\150\123\162\275\057\122\264\216\131\370\102\071\037\224\252"
	"\076\120\010\051\246\213\135\171\146\042\332\345\001\364\304\175"
	"\225\154\025\225\117\037\272\072\105\356\147\001\210\121\352\171"
	"\334\020\006\347\144\057\151\220\025\043\252\217\202\044\100\062"
	"\302\044\302\122\346\150\061\267\321\377\261\107\134\011\162\342"
	"\051\173\135\073\111\133\124\047\217\243\033\317\272\270\135\211"
	"\023\150\011\350\113\023\174\320\151\257\141\222\124\065\266\326"
	"\276\124\026\277\323\107\145\226\225\077\240\137\205\033\127\255"
	"\046\054\157\222\035\141\141\073\151\253\310\312\172\357\232\166"
	"\251\220\321\140\373\357\151\074\156\020\062\273\151\222\132\245"
	"\170\221\136\340\142\331\300\127\133\163\257\220\304\011\200\054"
	"\353\074\315\251\075\070\137\220\144\254\045\300\015\374\344\352"
	"\000\230\141\177\153\106\306\253\045\126\120\056\022\134\031\220"
	"\010\014\251\172\330\120\355\047\201\043\147\256\133\070\162\032"
	"\314\313\317\253\177\117\311\263\203\241\336\067\256\203\072\014"
	"\324\122\057\036\371\037\166\122\351\144\035\236\305\212\346\023"
	"\052\042\024\363\216\120\276\075\341\031\053\000\051\330\143\351"
	"\062\077\060\267\307\227\345\047\304\003\106\073\115\113\211\211"
	"\270\315\311\155\226\363\235\241\107\243\123\145\232\100\067\125"
	"\157\135\367\127\241\250\104\022\371\217\341\043\325\310\374\151"
	"\220\364\371\367\007\077\076\142\360\136\236\202\131\103\114\211"
	"\115\041\261\207\253\131\331\041\031\360\225\110\255\303\272\160"
	"\010\244\343\270\256\203\131\230\071\114\232\200\244\204\365\255"
	"\033\214\047\003\242\222\220\376\106\064\055\103\071\142\065\105"
	"\300\160\073\376\265\330\107\107\141\134\314\117\010\015\243\304"
	"\311\267\110\363\321\224\232\174\220\060\230\243\362\000\027\067"
	"\357\101\337\211\325\366\337\373\145\337\304\356\255\304\156\235"
	"\042\006\223\211\205\137\143\371\212\245\115\052\102\070\245\102"
	"\254\042\005\335\216\220\100\254\333\341\043\231\323\346\177\304"
	"\275\307\123\230\042\306\376\173\153\074\130\310\266\037\224\020"
	"\326\077\173\201\154\271\230\317\032\212\351\341\265\016\306\056"
	"\230\061\167\372\212\223\176\054\156\117\353\200\271\141\051\145"
	"\355\017\330\253\313\061\142\123\053\200\274\265\203\332\003\042"
	"\211\016\076\201\252\070\346\276\352\024\326\122\270\175\357\146"
	"\201\214\064\066\010\062\225\235\247\016\025\362\356\153\156\035"
	"\173\001\223\211\211\262\241\005\277\321\313\175\163\076\340\004"
	"\326\374\326\204\320\126\372\050\100\360\105\222\013\037\146\324"
	"\317\222\361\135\376\211\076\350\002\055\051\254\116\102\051\133"
	"\246\313\120\340\227\332\234\272\103\005\300\163\030\207\136\020"
	"\157\076\120\057\210\305\177\332\131\323\225\115\163\141\364\212"
	"\157\005\067\244\035\233\145\067\311\151\043\251\154\370\125\333"
	"\036\264\346\273\313\023\127\141\043\133\270\157\033\205\333\005"
	"\231\352\114\170\317\133\233\232\340\013\014\155\301\237\036\327"
	"\255\151\127\056\057\056\277\113\150\273\375\115\106\345\172\036"
	"\335\344\050\335\246\303\307\047\170\012\256\227\103\310\054\334"
	"\011\325\121\364\121\373\267\141\245\173\012\275\311\204\304\244"
	"\230\146\332\172\323\031\100\102\361\024\071\336\166\313\111\070"
	"\110\210\237\063\207\374\357\035\320\142\155\137\352\137\331\017"
	"\330\157\141\216\331\155\032\252\262\232\076\251\236\371\237\113"
	"\164\122\114\260\235\350\201\336\226\165\012\043\021\013\260\072"
	"\024\064\262\146\176\012\144\131\112\252\111\355\014\105\211\302"
	"\306\351\223\231\375\117\341\342\253\141\320\077\021\256\072\373"
	"\126\355\265\243\073\253\356\250\275\273\377\042\233\313\217\376"
	"\121\114\146\071\330\060\076\302\230\352\174\257\055\242\127\035"
	"\152\263\012\322\166\013\015\243\335\223\335\212\320\154\042\106"
	"\154\315\237\227\357\011\373\032\101\040\250\211\202\027\050\276"
	"\345\052\031\022\073\070\175\011\211\075\204\114\316\266\356\234"
	"\007\105\250\023\323\046\165\077\312\227\034\106\022\066\117\366"
	"\154\052\056\203\300\225\305\133\154\117\007\016\170\362\142\017"
	"\113\222\174\012\146\133\143\251\222\273\000\375\350\305\227\330"
	"\075\210\324\002\216\166\254\221\347\072\142\330\354\360\312\173"
	"\330\032\361\114\242\205\043\235\140\237\172\360\222\165\063\312"
	"\056\134\164\373\237\132\150\163\356\171\161\026\073\354\042\265"
	"\263\261\027\205\100\254\140\133\007\017\114\175\125\115\020\314"
	"\377\365\330\374\133\036\250\316\000\146\171\010\260\313\205\124"
	"\061\204\065\141\055\067\261\220\100\336\305\302\173\257\375\050"
	"\255\326\336\130\057\315\056\160\376\274\146\272\313\134\201\036"
	"\343\200\351\111\300\124\013\305\001\333\116\256\327\210\130\245"
	"\364\162\267\357\121\176\010\040\020\172\035\012\353\043\004\171"
	"\227\060\365\164\003\222\346\116\025\227\305\271\172\310\374\177"
	"\100\033\125\212\215\165\021\100\046\247\237\053\054\076\067\201"
	"\356\027\245\046\055\251\017\246\066\130\161\237\170\237\200\260"
	"\242\251\317\366\336\251\314\264\253\266\375\054\261\045\213\317"
	"\251\006\314\141\246\065\106\040\217\262\305\015\104\047\154\303"
	"\301\147\174\030\050\171\323\053\070\320\247\352\365\062\271\236"
	"\070\205\377\337\273\106\377\112\370\304\130\075\354\305\001\255"
	"\054\176\306\124\367\231\200\060\151\047\032\137\131\324\376\222"
	"\131\376\161\025\104\161\137\074\066\270\172\042\175\173\320\252"
	"\371\226\376\361\057\176\041\231\245\074\370\377\020\367\221\152"
	"\365\003\177\071\164\337\166\253\230\360\315\025\154\235\277\145"
	"\063\276\126\143\074\170\374\342\265\365\342\305\354\163\060\342"
	"\167\257\033\354\217\221\227\047\202\144\075\356\002\375\124\065"
	"\273\253\231\370\044\226\333\331\213\275\237\170\061\320\132\250"
	"\200\166\224\017\010\053\067\212\220\164\171\222\161\316\310\055"
	"\171\141\045\235\367\001\167\203\276\027\373\357\347\126\230\147"
	"\315\054\166\325\130\255\137\350\042\331\172\223\247\102\301\040"
	"\244\346\276\233\347\066\036\246\115\032\226\064\161\056\233\076"
	"\132\022\023\263\300\163\233\342\114\026\166\364\131\067\025\375"
	"\036\323\231\006\012\267\254\127\322\102\214\103\161\050\201\314"
	"\072\224\177\373\010\033\336\124\061\124\110\213\214\135\211\252"
	"\061\042\261\073\331\135\223\253\240\037\357\021\107\160\335\202"
	"\005\135\176\015\170\134\141\252\261\252\065\075\010\276\350\072"
	"\340\231\166\272\367\012\146\230\051\125\251\161\306\207\364\313"
	"\344\162\330\135\316\072\007\177\345\074\275\356\373\245\050\334"
	"\076\237\226\066\251\375\316\323\123\170\104\031\000\070\344\345"
	"\253\274\102\171\367\111\371\334\206\266\312\202\134\363\136\233"
	"\223\365\321\074\362\237\020\105\030\125\137\030\216\103\375\071"
	"\000\077\262\367\211\254\323\020\142\236\222\276\222\360\131\045"
	"\346\053\142\331\313\163\037\343\310\176\373\126\301\370\217\301"
	"\070\102\270\302\356\214\322\121\053\144\020\276\125\152\343\073"
	"\225\106\024\141\271\064\104\201\262\077\330\163\070\150\065\161"
	"\252\356\063\231\173\005\353\246\152\374\144\277\146\110\373\374"
	"\217\020\135\110\104\242\312\366\341\243\152\032\013\237\213\266"
	"\215\277\117\010\305\073\257\057\067\024\357\236\134\353\233\353"
	"\373\370\064\077\232\377\066\174\242\240\227\255\077\043\143\315"
	"\342\263\326\247\357\205\327\046\231\307\304\366\262\137\342\255"
	"\130\027\355\363\026\043\160\270\303\007\146\003\052\312\320\015"
	"\176\247\265\155\054\215\223\306\124\130\275\006\270\237\264\021"
	"\266\241\004\315\305\165\206\211\174\354\214\247\267\135\264\066"
	"\004\151\243\061\366\067\370\113\220\265\122\110\124\006\132\013"
	"\250\137\330\155\324\137\366\120\114\203\367\003\340\254\071\345"
	"\026\335\026\015\024\016\130\245\304\252\356\031\261\110\044\131"
	"\247\375\307\173\134\276\314\250\101\304\254\042\160\346\007\206"
	"\303\036\223\330\055\354\175\361\226\154\012\110\264\057\242\134"
	"\055\151\327\211\050\244\062\151\150\336\214\330\305\224\137\210"
	"\263\362\141\340\336\337\322\165\113\335\276\377\015\140\134\072"
	"\312\064\304\362\330\367\134\100\326\350\031\233\174\170\044\057"
	"\153\205\020\111\144\343\277\257\300\176\257\316\336\013\010\251"
	"\077\315\233\027\304\367\130\232\340\161\065\135\351\131\214\124"
	"\336\235\236\103\201\136\362\101\334\242\020\273\255\030\144\354"
	"\345\000\004\252\367\134\104\330\316\172\065\270\323\302\014\262"
	"\137\253\365\340\012\350\042\347\212\062\242\070\113\007\045\061"
	"\007\051\333\377\206\040\327\125\232\014\015\155\316\031\040\056"
	"\305\026\017\317\376\061\266\211\144\131\301\257\140\347\341\150"
	"\020\275\147\227\335\077\354\167\113\371\345\032\023\006\110\331"
	"\034\127\250\033\211\137\244\355\270\146\235\031\115\177"
#define      tst1_z	22
#define      tst1	((&data[4914]))
	"\351\365\236\343\241\174\010\310\035\014\302\120\333\041\154\246"
	"\363\377\163\212\237\273\377\124\032"
#define      shll_z	10
#define      shll	((&data[4939]))
	"\165\334\300\042\313\013\204\043\374\074\250\317\167"
#define      msg2_z	19
#define      msg2	((&data[4954]))
	"\330\311\232\060\003\277\361\262\273\060\011\346\015\013\065\114"
	"\226\270\155\131\334\107\323\161\265"
#define      tst2_z	19
#define      tst2	((&data[4979]))
	"\247\212\300\105\244\325\072\372\031\160\020\273\003\107\002\313"
	"\072\037\265\254\236\241\314\243"
#define      lsto_z	1
#define      lsto	((&data[4999]))
	"\122"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
